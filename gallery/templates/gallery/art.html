{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container py-4">

  <!-- Hero section -->
  <section class="position-relative">

    <!-- Hero image with title -->
    <div class="rounded overflow-hidden shadow-sm">
      <img class="w-100 hero-image" src="{% static 'images/hero-current.webp' %}" alt="Hero image">
      <div class="position-absolute top-50 start-50 translate-middle text-center text-white px-3">
        <h1 class="display-6 fw-bold text-shadow">Cecilia K.</h1>
        <p class="lead m-0 text-shadow"><i>I am a mother artist</i></p>
      </div>
    </div>
  </section>

  <!-- Category divider -->
  <div class="d-flex align-items-center my-4">
    <hr class="flex-grow-1">
    <span class="px-3 text-muted text-uppercase small">Featured Art</span>
    <hr class="flex-grow-1">
  </div>

    <!-- Delete confirmation modal for category -->
  <div class="modal fade" id="deleteCategoryModal" tabindex="-1" aria-labelledby="deleteCategoryModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deleteCategoryModalLabel">Delete category?</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          Are you sure you want to delete this category? 
          <br>This will not delete the media, but will delete any text content associated with it. 
          <br>This action cannot be undone.
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <a id="deleteCategoryConfirm" href="#" class="btn btn-danger">Delete</a>
        </div>
      </div>
    </div>
  </div>

      <!-- Delete confirmation modal for media -->
  <div class="modal fade" id="deleteMediaModal" tabindex="-1" aria-labelledby="deleteMediaModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deleteMediaModalLabel">Delete media?</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          Are you sure you want to delete this media? 
          <br>This action cannot be undone.
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <a id="deleteMediaConfirm" href="#" class="btn btn-danger">Delete</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Art pieces -->
  <!-- <section class="row g-3">
    {% for category in categories %}
    <div class="col-12 col-md-6 col-lg-4">
      <div class="card h-100 shadow-sm">
        <img class="card-img-top" src="{{ category.associated_media.image.url }}" alt="{{ category.associated_media.alt_text }}">
        <div class="card-body">
          <h5 class="card-title">{{ category.name | safe }}</h5>
        </div>
      </div>
    </div>
    {% endfor %}
  </section> -->

  <section class="row g-3">
  {% for category in categories %}
    <div class="col-12">
      <h3 class="mt-4 mb-3">{{ category.name }}</h3>
      <a class="btn btn-delete" data-category_id="{{ category.id }}">Delete</a>
      <div class="row">
        {% for media in category.media.all %}
          <div class="col-md-6 col-lg-4 mb-4">
            <div class="card h-100 shadow-sm">
              {% if media.image %}
                <img class="card-img-top" src="{{ media.image.url }}" alt="{{ media.alt_text }}">
              {% elif media.video %}
                <div class="ratio ratio-16x9">
                  <iframe src="{{ media.video }}" title="{{ media.title }}" allowfullscreen></iframe>
                </div>
              {% endif %}
              <div class="card-body">
                <h5 class="card-title">{{ media.title }}</h5>
                <!-- <p class="card-text">{{ media.alt_text }}</p> -->
                <!-- <small class="text-muted">{{ media.created_on }}</small> -->
                <a class="btn btn-warning" data-media_id="{{ media.id }}">Delete Media</a>
              </div>
            </div>
          </div>
        
        {% empty %}

          <div class="col-md-6 col-lg-4 mb-4">
            <div class="card h-100 shadow-sm">
                <img src="{% static 'images/placeholder.webp' %}" class="scale product-page-image" alt="placeholder">
                <div class="ratio ratio-16x9">
                  <iframe src="{{ media.video }}" title="{{ media.title }}" allowfullscreen></iframe>
                </div>
              <div class="card-body">
                <h5 class="card-title">{{ media.title }}</h5>
                <!-- <p class="card-text">{{ media.alt_text }}</p> -->
                <!-- <small class="text-muted">{{ media.created_on }}</small> -->
              </div>
            </div>
          </div>

          <!--      THIS WILL BE THE FINAL SECTION -->
          <!--
          <div class="col-12"><em>No media in this category.</em></div>
          <a class="ms-3 text-white" href="#">Delete</a>
          -->
        {% endfor %}
      </div>
    </div>
  {% endfor %}
</section>

  <!-- Bottom divider -->
  <div class="d-flex align-items-center my-4">
    <hr class="flex-grow-1">
    <span class="px-3 text-muted text-uppercase small">Browse Categories</span>
    <hr class="flex-grow-1">
  </div>
</div>

{% endblock content %}

{% block extras %}
<script src="{% static 'js/admin_commands.js' %}"></script>
<style>
  .hero-image { height: 300px; object-fit: cover; filter: saturate(1.05); }
  .text-shadow { text-shadow: 0 2px 8px rgba(0,0,0,.5); }
  .card-img-top {
    width: 100%;
    height: 550px;
    object-fit: cover;      /* Fills the area, cropping as needed */
    background: #f8f9fa;    /* Optional: fallback background */
  }
  .card {
    min-height: 500px;  /* Adjust as needed for your layout */
  }
</style>
{% endblock %}